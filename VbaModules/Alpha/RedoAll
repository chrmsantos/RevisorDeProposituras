'--------------------------------------------------------------------------------
' Botão: Refaz todas as alterações
'--------------------------------------------------------------------------------
' SUBROTINA: RedoAllChanges
' Finalidade: Refaz todas as alterações realizadas no documento ativo.
'--------------------------------------------------------------------------------
Sub RedoAllChanges()
    On Error GoTo ErrorHandler

    ' Verifica se há um documento ativo
    If Documents.Count = 0 Then
        MsgBox "Nenhum documento está aberto para refazer alterações.", vbExclamation, "Documento não encontrado"
        Exit Sub
    End If

    Dim doc As Document: Set doc = ActiveDocument

    ' Verifica se há alterações a serem refeitas
    If doc.Saved Then
        MsgBox "Nenhuma alteração foi realizada desde o último salvamento.", vbInformation, "Nada a refazer"
        Exit Sub
    End If

    ' Desativa atualizações e eventos para melhorar o desempenho
    Application.ScreenUpdating = False
    Application.EnableEvents = False

    ' Refaz todas as alterações realizadas no documento
    Dim redoCount As Long: redoCount = 0
    Dim maxRedo As Long: maxRedo = 1000 ' Limite de operações de refazer (ajustável)
    
    Do While doc.Redo
        redoCount = redoCount + 1
        If redoCount >= maxRedo Then Exit Do ' Evita loops infinitos em documentos muito grandes
    Loop

    ' Restaura configurações
    Application.ScreenUpdating = True
    Application.EnableEvents = True

    ' Mensagem de conclusão
    MsgBox "Todas as alterações realizadas desde a abertura do arquivo ou do último salvamento foram refeitas com sucesso.", _
           vbInformation, "Alterações Refeitas"
    Exit Sub

ErrorHandler:
    ' Restaura configurações em caso de erro
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    MsgBox "Erro " & Err.Number & ": " & Err.Description, vbCritical, "Erro ao Refazer Alterações"
End Sub